<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tìm kiếm khách hàng</title>
    <style>
        #customer-list div {
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }

        #pagination button {
            margin: 5px;
            padding: 8px 12px;
            cursor: pointer;
        }

        #pagination button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>

<body>

    <h2>Tìm kiếm khách hàng</h2>
    <input type="text" id="search-input" placeholder="Nhập tên, số điện thoại hoặc địa chỉ">
    <button onclick="fetchCustomers(1)">Tìm kiếm</button>

    <div id="customer-list"></div>
    <div id="pagination"></div>

    <script>
        let currentPage = 1;
        const itemsPerPage = 5;

        // Hàm lấy dữ liệu từ PHP (AJAX)
        function fetchCustomers(page) {
            const searchQuery = document.getElementById("search-input").value;

            fetch(`resultSearch.php?search=${searchQuery}&page=${page}`)
                .then(response => response.json())
                .then(data => {
                    displayCustomers(data.customers);
                    renderPagination(data.totalPages, data.currentPage, searchQuery);
                })
                .catch(error => console.error("Lỗi lấy dữ liệu:", error));
        }

        // Hiển thị khách hàng
        function displayCustomers(customers) {
            document.getElementById("customer-list").innerHTML = customers.length > 0
                ? customers.map(c => `<div><strong>${c.username}</strong> - ${c.numberphone} - ${c.address}</div>`).join("")
                : "<div>Không tìm thấy khách hàng</div>";
        }

        // Tạo nút phân trang
        function renderPagination(totalPages, currentPage, searchQuery) {
            let paginationHTML = '';

            if (currentPage > 1) {
                paginationHTML += `<button onclick="fetchCustomers(${currentPage - 1}, '${searchQuery}')">Trước</button>`;
            }

            for (let i = 1; i <= totalPages; i++) {
                paginationHTML += `<button onclick="fetchCustomers(${i}, '${searchQuery}')" ${i === currentPage ? "disabled" : ""}>${i}</button> `;
            }

            if (currentPage < totalPages) {
                paginationHTML += `<button onclick="fetchCustomers(${currentPage + 1}, '${searchQuery}')">Sau</button>`;
            }

            document.getElementById("pagination").innerHTML = paginationHTML;
        }

        // Gọi API lần đầu khi trang load
        fetchCustomers(currentPage);
    </script>

</body>

</html>